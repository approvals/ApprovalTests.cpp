<!--
GENERATED FILE - DO NOT EDIT
This file was generated by [MarkdownSnippets](https://github.com/SimonCropp/MarkdownSnippets).
Source File: /doc/mdsource/TestingCombinations.source.md
To change this file edit the source file and then execute ./run_markdown_templates.sh.
-->

<a id="top"></a>

# Testing Combinations

You can use `CombinationApprovals::verifyAllCombinations` to test the content of multiple containers.

This makes a kind of approval test matrix, automatically testing all combinations of a set of inputs. It's a powerful way to quickly get very good test coverage.

In this small example, all combinations of `{"hello", "world"}` and `{1, 2, 3}` are being used:

<!-- snippet: YouCanVerifyCombinationsOf2 -->
<a id='snippet-youcanverifycombinationsof2'/></a>
```cpp
TEST_CASE("YouCanVerifyCombinationsOf2") {
    std::vector<std::string> v{"hello", "world"};
    std::vector<int> numbers{1, 2, 3};
    CombinationApprovals::verifyAllCombinations(
            [](std::string s, int i){return std::make_pair(s, i);},
            v,
            numbers);
}
```
<sup>[snippet source](/tests/Catch2_Tests/CombinationTests.cpp#L45-L54) / [anchor](#snippet-youcanverifycombinationsof2)</sup>
<!-- endsnippet -->

The format is carefully chosen to show both inputs and outputs, to make the test results easy to interpret. The output looks like this:

<!-- snippet: CombinationTests.YouCanVerifyCombinationsOf2.approved.txt -->
<a id='snippet-CombinationTests.YouCanVerifyCombinationsOf2.approved.txt'/></a>
```txt
(hello, 1) => (hello, 1)
(hello, 2) => (hello, 2)
(hello, 3) => (hello, 3)
(world, 1) => (world, 1)
(world, 2) => (world, 2)
(world, 3) => (world, 3)

```
<sup>[snippet source](/tests/Catch2_Tests/approval_tests/CombinationTests.YouCanVerifyCombinationsOf2.approved.txt#L1-L7) / [anchor](#snippet-CombinationTests.YouCanVerifyCombinationsOf2.approved.txt)</sup>
<!-- endsnippet -->

For advice on effective formatting, see [To String](/doc/ToString.md#top). As you write out larger volumes of data in your approval files, experience has shown that the choice of layout of text in approval files can make a big difference to maintainability of tests, when failures occur.

## Code samples

<!-- snippet: sample_combinations_of_three -->
<a id='snippet-sample_combinations_of_three'/></a>
```cpp
CombinationApprovals::verifyAllCombinations(
        []( const std::string& input1, const int input2, const double input3)
        {
            return functionThatReturnsSomethingOutputStreamable(input1, input2, input3);
        }, // This is the converter function
        listOfInput1s,
        listOfInput2s,
        listOfInput3s);
```
<sup>[snippet source](/tests/Catch2_Tests/documentation/CombinationsSampleCode.cpp#L25-L34) / [anchor](#snippet-sample_combinations_of_three)</sup>
<!-- endsnippet -->

If you are using C++14 or above, you can simplify this by using `auto` or `auto&` for the lambda parameters:

<!-- snippet: sample_combinations_of_three_with_auto -->
<a id='snippet-sample_combinations_of_three_with_auto'/></a>
```cpp
CombinationApprovals::verifyAllCombinations(
        []( auto& input1, auto& input2, auto& input3)
        {
            return functionThatReturnsSomethingOutputStreamable(input1, input2, input3);
        }, // This is the converter function
        listOfInput1s,
        listOfInput2s,
        listOfInput3s);
```
<sup>[snippet source](/tests/Catch2_Tests/documentation/CombinationsSampleCode.cpp#L43-L52) / [anchor](#snippet-sample_combinations_of_three_with_auto)</sup>
<!-- endsnippet -->

---

[Back to User Guide](/doc/README.md#top)
